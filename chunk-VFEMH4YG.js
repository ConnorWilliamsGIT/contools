import{a as Q}from"./chunk-3GHLPITM.js";import"./chunk-QWULPANI.js";import{Ka as x,La as B,Ma as y,Na as S,P as F,Ta as l,Ua as v,Va as p,Ya as L,na as C}from"./chunk-FZ62MYCG.js";var m=class{constructor(a,d,i=0){this.pos={x:0,y:0},this.vel={x:0,y:0},this.heading=0,this.maxSpeed=300,this.minSpeed=80,this.protectedRange=50,this.visualRange=100,this.separationFactor=.05,this.alignmentFactor=.01,this.cohesionFactor=5e-4,this.turnFactor=4,this.timeLast=0,this.pos.x=a,this.pos.y=d,this.heading=i,this.timeLast=Date.now()}setCoordinate(a){this.pos.x=a.x,this.pos.y=a.y}computePosition(a,d,i,e){let s=0,t=0,n=0,o=0,h=0;a.forEach((c,w)=>{if(w===i)return;let f=d[i][w];f<this.protectedRange&&(this.vel.x+=(this.pos.x-c.pos.x)*this.separationFactor,this.vel.y+=(this.pos.y-c.pos.y)*this.separationFactor),f<this.visualRange&&f>this.protectedRange&&(s+=c.vel.x,t+=c.vel.y,n+=c.pos.x,o+=c.pos.y,h++)}),h>0&&(s/=h,t/=h,this.vel.x+=(s-this.vel.x)*this.alignmentFactor,this.vel.y+=(t-this.vel.y)*this.alignmentFactor,n/=h,o/=h,this.vel.x+=(n-this.pos.x)*this.cohesionFactor,this.vel.y+=(o-this.pos.y)*this.cohesionFactor),this.pos.x<e.left&&(this.vel.x+=this.turnFactor),this.pos.x>e.right&&(this.vel.x-=this.turnFactor),this.pos.y<e.top&&(this.vel.y+=this.turnFactor),this.pos.y>e.bottom&&(this.vel.y-=this.turnFactor);let r=Math.sqrt(this.vel.x*this.vel.x+this.vel.y*this.vel.y);r>this.maxSpeed&&(this.vel.x=this.vel.x/r*this.maxSpeed,this.vel.y=this.vel.y/r*this.maxSpeed),r<this.minSpeed&&(this.vel.x=this.vel.x/r*this.minSpeed,this.vel.y=this.vel.y/r*this.minSpeed);let g=this.getTimeStep();this.pos.x+=this.vel.x*g,this.pos.y+=this.vel.y*g,this.heading=Math.atan2(this.vel.y,this.vel.x)+Math.PI/2}getTimeStep(){let a=Date.now(),d=a-this.timeLast;return this.timeLast=a,d/1e3}};var R=["canvas"],E=["canvasFrame"],M=["image"],_=["deleteButton"],q=["resetButton"],D=(()=>{let a=class a{constructor(){this.boidList=[]}ngAfterViewInit(){if(this.canvas===void 0||this.canvasFrame===void 0){console.log("Canvas not found");return}let i=setInterval(()=>{this.computeBoids()},10);this.ctx=this.canvas.nativeElement.getContext("2d"),this.resizeCanvas(),this.spawnBoids(100),this.updateCanvas()}resizeCanvas(){if(this.canvas===void 0||this.canvasFrame===void 0){console.log("Canvas not found");return}let i=this.canvasFrame.nativeElement;this.ctx.canvas.width=i.clientWidth,this.ctx.canvas.height=i.clientHeight,this.updateCanvas()}updateCanvas(){this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.boidList.forEach(i=>this.drawBoid(i))}drawBoid(i){this.ctx.save(),this.ctx.translate(i.pos.x,i.pos.y),this.ctx.rotate(i.heading),this.ctx.beginPath(),this.ctx.moveTo(0,-10),this.ctx.lineTo(7,10),this.ctx.lineTo(-7,10),this.ctx.lineTo(0,-10),this.ctx.fillStyle="white",this.ctx.fill(),this.ctx.closePath(),this.ctx.restore()}spawnBoids(i,e=-1,s={x:this.ctx.canvas.width/2,y:this.ctx.canvas.height/2}){let t,n;e===-1?(t=this.ctx.canvas.width-80,n=this.ctx.canvas.height-80):(t=e,n=e);for(let o=0;o<i;o++){let h=s.x+Math.random()*t-t/2,r=s.y+Math.random()*n-n/2;this.boidList.push(new m(h,r))}}computeBoids(){this.boidList.forEach(e=>{let s=[];this.boidList.forEach((t,n)=>{s.push([]),this.boidList.forEach((o,h)=>{s[n].push(Math.sqrt((t.pos.x-o.pos.x)**2+(t.pos.y-o.pos.y)**2))})}),e.computePosition(this.boidList,s,this.boidList.indexOf(e),{left:80,right:this.ctx.canvas.width-80,top:80,bottom:this.ctx.canvas.height-80})}),this.updateCanvas()}};a.\u0275fac=function(e){return new(e||a)},a.\u0275cmp=F({type:a,selectors:[["app-boids"]],viewQuery:function(e,s){if(e&1&&(l(R,5),l(E,5),l(M,5),l(_,5),l(q,5)),e&2){let t;v(t=p())&&(s.canvas=t.first),v(t=p())&&(s.canvasFrame=t.first),v(t=p())&&(s.image=t.first),v(t=p())&&(s.deleteButton=t.first),v(t=p())&&(s.resetButton=t.first)}},hostBindings:function(e,s){e&1&&S("resize",function(){return s.resizeCanvas()},!1,C)},standalone:!0,features:[L],decls:6,vars:0,consts:[["settings",""],["canvas","",1,"w-full","h-full","relative"],["canvasFrame",""],["canvas",""]],template:function(e,s){e&1&&(x(0,"app-layout"),y(1,"div",0),x(2,"div",1,2),y(4,"canvas",null,3),B()())},dependencies:[Q]});let u=a;return u})();export{D as BoidsComponent};

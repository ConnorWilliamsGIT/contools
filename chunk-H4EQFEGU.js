import{a as M}from"./chunk-YGAGSPF3.js";import{a as E,b as y,c as v,d as w,e as x,f as _,g as c,h as p,i as L,j as g,m as r,n as d,o as h,p as m,q as C,r as b}from"./chunk-G5YMYTWS.js";var a=class{constructor(n,f){this.x=0,this.y=0,this.adjacentNodes=[],this.visited=!1,this.id=0,this.x=n,this.y=f}get isVisited(){return this.visited}get getId(){return this.id}setVisited(n){this.visited=n}setId(n){this.id=n}setCoordinate(n){this.x=n.x,this.y=n.y}addAdjacentNode(n){this.adjacentNodes.push(n)}removeAdjacentNode(n){this.adjacentNodes=this.adjacentNodes.filter(f=>f!==n)}isAdjacent(n){return this.adjacentNodes.includes(n)}};var S=["canvas"],H=["canvasFrame"],N=["image"],D=["deleteButton"],T=["resetButton"],I=(()=>{let n=class n{constructor(){this.buttonHovered=!1,this.nodeRadius=15,this.nodeList=[],this.graphList=_([]),this.graphString=x(()=>(console.log("updated graph string"),this.graphsToString(this.graphList()))),this.drawingEdge=!1,this.tempEdgeSource=new a(0,0),this.tempEdgeEnd=new a(0,0),this.selectorThickness=this.nodeRadius*.2,this.selectorOuterRadius=this.nodeRadius*1.4,this.Mode={DEFAULT:Symbol("default"),DELETE:Symbol("delete"),MOVE:Symbol("move")},this.currentMode=this.Mode.DEFAULT,this.shiftEnabled=!1,this.mousePos={x:0,y:0}}isButtonHovered(e){this.buttonHovered=e}ngAfterViewInit(){if(this.canvas===void 0||this.canvasFrame===void 0){console.log("Canvas not found");return}this.ctx=this.canvas.nativeElement.getContext("2d"),this.resizeCanvas()}resizeCanvas(){if(this.canvas===void 0||this.canvasFrame===void 0){console.log("Canvas not found");return}let e=this.canvasFrame.nativeElement;this.ctx.canvas.width=e.clientWidth,this.ctx.canvas.height=e.clientHeight,this.updateCanvas()}renderImage(){let e=new Image;e.onload=()=>{let t=(this.ctx.canvas.width-e.width*.3)/2,i=(this.ctx.canvas.height-e.height*.3)/2;this.ctx.drawImage(e,t,i,e.width*.3,e.height*.3)},e.src="https://media.licdn.com/dms/image/D5603AQHNteNbj0wR1w/profile-displayphoto-shrink_800_800/0/1705715328463?e=1715212800&v=beta&t=wVcIyNOl3h_1b_FK7aloU_aWNC7fHl9UrdbQhSdj1XU"}pageToCanvasPos(e){return{x:e.x-this.canvasFrame?.nativeElement.offsetLeft,y:e.y-this.canvasFrame?.nativeElement.offsetTop}}drawNode(e,t="white"){this.ctx.beginPath(),this.ctx.arc(e.x,e.y,this.nodeRadius,0,2*Math.PI),this.ctx.closePath(),this.ctx.fillStyle=t,this.ctx.fill()}getNodeDistance(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}selectNodeEdgeDrawing(e){let t=.4*Math.PI,i=Math.atan2(this.tempEdgeEnd.y-e.y,this.tempEdgeEnd.x-e.x);this.getNodeDistance(e,this.tempEdgeEnd)<this.selectorOuterRadius&&(t=0);let s=i+t/2;this.drawSelectArc(e,"lightblue",t,s)}selectNodeDelete(){this.updateCanvas();let e=this.pageToCanvasPos({x:this.mousePos.x,y:this.mousePos.y}),t=this.checkSpace(e);if(t.occupied){let i=0,s=0;if(this.drawSelectArc(t.node,"rgba(255,0,0,0.5)",i,s),this.shiftEnabled){let o=this.graphList().find(u=>u.nodes.includes(t.node));o!==void 0&&o.nodes.forEach(u=>this.drawSelectArc(u,"rgba(255,0,0,0.5)",i,s))}}}deleteNode(e){this.nodeList=this.nodeList.filter(t=>t!==e),this.nodeList.forEach(t=>t.removeAdjacentNode(e)),this.graphList.update(t=>t.map(i=>(i.nodes=i.nodes.filter(s=>s!==e),i)))}deleteGraph(e){this.nodeList=this.nodeList.filter(t=>!e.nodes.includes(t)),this.createGraphs()}drawSelectArc(e,t="lightblue",i=0,s=0){this.ctx.beginPath(),this.ctx.arc(e.x,e.y,this.selectorOuterRadius,s,2*Math.PI-i+s,!1),this.ctx.arc(e.x,e.y,this.selectorOuterRadius-this.selectorThickness,2*Math.PI-i+s,s,!0),this.ctx.closePath(),this.ctx.fillStyle=t,this.ctx.fill()}drawEdge(e,t){this.ctx.lineWidth=4,this.ctx.beginPath(),this.ctx.moveTo(e.x,e.y),this.ctx.lineTo(t.x,t.y),this.ctx.closePath(),this.ctx.strokeStyle="white",this.ctx.stroke()}updateCanvas(){this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.currentMode===this.Mode.DELETE&&(this.ctx.fillStyle="rgba(255, 0, 0, 0.1)",this.ctx.fillRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height)),this.graphList().forEach(e=>this.drawGraph(e)),this.drawingEdge&&this.selectNodeEdgeDrawing(this.tempEdgeSource)}drawGraph(e){e.nodes.forEach(t=>{this.drawNode(t),t.adjacentNodes.forEach(i=>this.drawEdge(t,i))})}checkSpace(e){for(let t=0;t<this.graphList().length;t++){let i=this.graphList()[t];for(let s=0;s<i.nodes.length;s++){let o=i.nodes[s];if(Math.sqrt(Math.pow(e.x-o.x,2)+Math.pow(e.y-o.y,2))<this.nodeRadius*2)return{occupied:!0,node:o}}}return{occupied:!1,node:new a(0,0)}}handleKeyDown(e){e.key==="Shift"&&(this.shiftEnabled=!0,this.currentMode===this.Mode.DELETE&&this.selectNodeDelete()),this.handleKeyboardEvent(e)}handleKeyUp(e){e.key==="Shift"&&(this.shiftEnabled=!1,this.currentMode===this.Mode.DELETE&&this.selectNodeDelete())}handleKeyboardEvent(e){let t=e.key;t==="r"&&this.resetGraphs(),t==="x"&&this.toggleDeleteMode()}resetGraphs(){this.nodeList=[],this.graphList.set([]),this.updateCanvas()}toggleDeleteMode(){this.currentMode===this.Mode.DELETE?(this.currentMode=this.Mode.DEFAULT,this.deleteButton?.nativeElement.classList.remove("btn-error"),this.deleteButton?.nativeElement.classList.add("opacity-50"),this.updateCanvas()):(this.currentMode=this.Mode.DELETE,this.deleteButton?.nativeElement.classList.add("btn-error"),this.deleteButton?.nativeElement.classList.remove("opacity-50"),this.updateCanvas(),this.selectNodeDelete())}onMouseMove(e){this.mousePos={x:e.pageX,y:e.pageY},this.currentMode===this.Mode.DELETE&&this.selectNodeDelete(),this.drawingEdge&&(this.updateCanvas(),this.tempEdgeEnd.setCoordinate(this.pageToCanvasPos({x:this.mousePos.x,y:this.mousePos.y})),this.drawEdge(this.tempEdgeSource,this.tempEdgeEnd))}onClick(e){let t=this.pageToCanvasPos({x:e.pageX,y:e.pageY});if(t.x<0||t.y<0||t.x>this.ctx.canvas.width||t.y>this.ctx.canvas.height||this.buttonHovered){this.drawingEdge=!1,this.updateCanvas();return}let i=this.checkSpace(t);if(this.currentMode===this.Mode.DELETE){if(i.occupied){if(this.shiftEnabled){let s=this.graphList().find(o=>o.nodes.includes(i.node));s!==void 0&&this.deleteGraph(s)}else this.deleteNode(i.node);this.createGraphs()}}else!i.occupied&&!this.drawingEdge?(this.nodeList.push(new a(t.x,t.y)),this.graphList.update(s=>[...s,{nodes:[this.nodeList[this.nodeList.length-1]]}])):i.occupied&&!this.drawingEdge?(this.drawingEdge=!0,this.tempEdgeSource=i.node,this.tempEdgeEnd.setCoordinate(t)):i.occupied&&this.drawingEdge?(this.drawingEdge=!1,i.node!=this.tempEdgeSource&&!this.tempEdgeSource.isAdjacent(i.node)&&(this.tempEdgeSource.addAdjacentNode(i.node),i.node.addAdjacentNode(this.tempEdgeSource),this.createGraphs())):!i.occupied&&this.drawingEdge&&(this.drawingEdge=!1);this.updateCanvas()}createGraphs(){this.nodeList.forEach(e=>e.visited=!1),this.graphList.set([]);for(let e=0;e<this.nodeList.length;e++){let t=this.nodeList[e];if(!t.visited){let i={nodes:[]};this.graphList().push(i),this.visitNode(t,i)}}console.log(this.graphList())}graphsToString(e){let t="";for(let i=0;i<e.length;i++)t+="Graph "+(i+1)+`
`,t+=this.graphToString(e[i]),t+=`

`;return t}graphToString(e){let t="";for(let i=0;i<e.nodes.length;i++){t+=e.nodes[i].id,t+=" -> ";for(let s=0;s<e.nodes[i].adjacentNodes.length;s++)t+=e.nodes[i].adjacentNodes[s].id,t+=" ";t+=`
`}return t+=`
`,t}visitNode(e,t,i=0){if(!e.visited){t.nodes.push(e),e.setId(i),e.visited=!0;for(let s=0;s<e.adjacentNodes.length;s++)this.visitNode(e.adjacentNodes[s],t,++i)}}};n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=E({type:n,selectors:[["app-home"]],viewQuery:function(t,i){if(t&1&&(r(S,5),r(H,5),r(N,5),r(D,5),r(T,5)),t&2){let s;d(s=h())&&(i.canvas=s.first),d(s=h())&&(i.canvasFrame=s.first),d(s=h())&&(i.image=s.first),d(s=h())&&(i.deleteButton=s.first),d(s=h())&&(i.resetButton=s.first)}},hostBindings:function(t,i){t&1&&g("resize",function(){return i.resizeCanvas()},!1,y)("keydown",function(o){return i.handleKeyDown(o)},!1,v)("keyup",function(o){return i.handleKeyUp(o)},!1,v)("mousemove",function(o){return i.onMouseMove(o)})("click",function(o){return i.onClick(o)})},standalone:!0,features:[b],decls:15,vars:1,consts:[["settings","",2,"user-select","none"],[1,"whitespace-pre-wrap"],["canvas","",1,"w-full","h-full","relative"],["canvasFrame",""],["canvas",""],["canvas_overlay","",1,"absolute","bottom-5","left-5","space-x-2","items-start"],["tabindex","-1",1,"btn","btn-square","btn-outline","opacity-50",3,"click","mouseout","mouseover"],["deleteButton",""],["resetButton",""]],template:function(t,i){t&1&&(c(0,"app-layout")(1,"div",0)(2,"div",1),m(3),p()(),c(4,"div",2,3),L(6,"canvas",null,4),c(8,"div",5)(9,"button",6,7),g("click",function(){return i.toggleDeleteMode()})("mouseout",function(){return i.isButtonHovered(!1)})("mouseover",function(){return i.isButtonHovered(!0)}),m(11," Delete X "),p(),c(12,"button",6,8),g("click",function(){return i.resetGraphs()})("mouseout",function(){return i.isButtonHovered(!1)})("mouseover",function(){return i.isButtonHovered(!0)}),m(14," Reset R "),p()()()()),t&2&&(w(3),C(" ",i.graphString()," "))},dependencies:[M]});let l=n;return l})();export{I as HomeComponent};

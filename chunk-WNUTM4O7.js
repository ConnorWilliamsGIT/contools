import{Da as k,Fa as b,Ga as B,Ha as D,Ia as P,Ja as M,Ka as m,La as a,Ma as h,Na as $,Oa as U,P as F,Ra as j,Wa as r,Xa as R,Ya as z,c as T,la as _,lb as A,qa as p,va as N}from"./chunk-FZ62MYCG.js";function O(i,l){if(i&1&&(m(0,"div")(1,"p",12),r(2," Note: Anvil image should look something like this."),h(3,"br"),r(4," Don't include the UI border or anything else in the screenshot. "),a(),h(5,"img",13),a()),i&2){let u=U();p(5),b("src",u.exampleImg,_)}}function q(i,l){i&1&&r(0," \u2192 ")}function W(i,l){if(i&1&&(h(0,"img",21),k(1,q,1,0)),i&2){let u=l.$implicit,t=l.$index,o=l.$count;j("src","assets/img/",u,".png",_),p(),B(1,t!==o-1?1:-1)}}function G(i,l){if(i&1&&(m(0,"div",14)(1,"div",15),h(2,"img",16),a(),h(3,"div",17),m(4,"div",18)(5,"p",19),r(6),h(7,"br"),r(8," Moves: "),a(),m(9,"div",20),P(10,W,2,2,null,null,D),a()()()),i&2){let u=U();p(2),b("src",u.imageUrl,_),p(4),R(" Steps: ",u.forgeText().length,""),p(4),M(u.forgeText())}}var Z=(()=>{let l=class l{constructor(){this.modalButton=document.getElementById("modal_button"),this.imageUrl="",this.exampleImg="../../../assets/img/exampleForge.png",this.forgeText=N([])}ngOnInit(){this.modalButton=document.getElementById("modal_button")}pasteImage(){return T(this,null,function*(){let t=yield navigator.clipboard.read();for(let o of t){if(!o.types.includes("image/png")){console.log("Clipboard item is not an image");continue}let e=yield o.getType("image/png");this.imageUrl=URL.createObjectURL(e),console.log("got here 1"),this.processImage()}})}processImage(){try{let t=document.createElement("canvas"),o=t.getContext("2d"),e=new Image;e.onload=()=>{if(o===null){console.log("Context is null");return}t.width=e.width,t.height=e.height,o.drawImage(e,0,0,t.width,t.height);let c=o.getImageData(0,0,e.width,e.height),w=0,d=!1,g=0,f=0;for(let n=0;n<e.height;n++){for(let s=0;s<e.width;s++){let S=this.getPixel(c,n*e.width+s);if(S[0]==63&&S[1]==63&&S[2]==63)w+=1,d||(d=!0,g=n,f=s);else if(d)break}if(d)break}if(!d)throw console.log("A not found"),new Error("A not found");console.log("count: "+w);let x=w/3;f-=x,console.log("aRow: "+g),console.log("aCol: "+f);let v=!1,I=0,H=!1,y=0,C=96;for(let n=0;n<e.width;n++){let s=this.getPixel(c,(C*x+g)*e.width+n);if(s[0]==0&&s[1]==255&&s[2]==6){I=n;break}}C=90;for(let n=0;n<e.width;n++){let s=this.getPixel(c,(C*x+g)*e.width+n);if(s[0]==255&&s[1]==0&&s[2]==0){y=n;break}}console.log("greenCol: "+I),console.log("redCol: "+y);let E=(y-I)/x;if(console.log("distance: "+E),isNaN(E))throw console.log("Distance is NaN"),new Error("Distance is NaN");let[J,L]=this.minStepsToN(E);this.forgeText.set(L.map(n=>n.toString())),o.putImageData(c,0,0),console.log("updated image"),this.imageUrl=t.toDataURL()},e.src=this.imageUrl;return}catch(t){console.log(t),console.log("Error processing image"),this.toggleModal(),this.imageUrl=""}}getPixel(t,o){return t.data.subarray(o*4,o*4+4)}setPixel(t,o,e){t.data.set(e,o*4)}toggleModal(){this.modalButton?(this.modalButton.click(),console.log("modalButton toggled")):console.log("modalButton not found")}minStepsToN(t){let o=[-15,-9,-6,-3,2,7,13,16],e=150;t=Math.abs(Math.round(t));let c=[{sum:0,steps:0,path:[]}],w=new Set([0]);for(;c.length>0;){let{sum:d,steps:g,path:f}=c.shift();if(d===t)return console.log(`Steps: ${g}`),console.log(`Path: ${f.join(" \u2192 ")}`),[g,f];for(let x of o){let v=d+x;v>e||w.has(v)||(c.push({sum:v,steps:g+1,path:[...f,x]}),w.add(v))}}return console.log("No solution found."),[-1,[]]}};l.\u0275fac=function(o){return new(o||l)},l.\u0275cmp=F({type:l,selectors:[["app-forge"]],standalone:!0,features:[z],decls:21,vars:2,consts:[[1,"text-center","content-center","justify-center","h-svh","max-h-svh","items-center","flex","flex-col"],[1,"text-3xl","flex-none","font-bold","p-3","text-center","w-100","text-secondary"],[1,"text-center","content-center","justify-center","items-center","flex-1","flex","flex-col","w-[100%]"],[1,"btn","btn-primary","grow-0",3,"click"],[4,"ngIf"],["class","flex w-[90%] items-start mt-10 gap-3 max-h-[700px]",4,"ngIf"],["id","modal_button","onclick","error_modal.showModal()",1,"btn","hidden"],["id","error_modal",1,"modal"],[1,"modal-box"],[1,"text-lg","font-bold"],[1,"py-4"],["method","dialog",1,"modal-backdrop"],[1,"text-neutral-content"],["alt","Example Image",3,"src"],[1,"flex","w-[90%]","items-start","mt-10","gap-3","max-h-[700px]"],[1,"outline","outline-base-content/50","rounded","rounded-4","grid","flex-none"],["alt","Pasted Image",3,"src"],[1,"inline-block","h-auto","min-h-[1em]","w-0.5","self-stretch","bg-base","dark:bg-white/10"],[1,"flex-1","max-h-[700px]","overflow-y-auto"],[1,"text-neutral-content","whitespace-normal"],[1,"flex","gap-1","items-center","justify-center","mt-5","flex-wrap"],["alt","Pasted Image",1,"w-10",3,"src"]],template:function(o,e){o&1&&(m(0,"div",0)(1,"h1",1),r(2,"Contools"),a(),m(3,"div",2)(4,"button",3),$("click",function(){return e.pasteImage()}),r(5,"Paste Image from clipboard"),a(),k(6,O,6,1,"div",4)(7,G,12,2,"div",5),a()(),m(8,"button",6),r(9,"open modal"),a(),m(10,"dialog",7)(11,"div",8)(12,"h3",9),r(13,"An error has occurred."),a(),m(14,"p",10),r(15,"Click anywhere to continue. "),h(16,"br"),r(17," If the error persists, close and reopen the page."),a()(),m(18,"form",11)(19,"button"),r(20,"close"),a()()()),o&2&&(p(6),b("ngIf",e.imageUrl==""),p(),b("ngIf",e.imageUrl!=""))},dependencies:[A]});let i=l;return i})();export{Z as ForgeComponent};
